migr_data1 <- read.csv("./data/data.csv")
GM1 <- c("Global Mean", NA, NA, NA, mean(migr_data1$ACMI), mean(migr_data1$MEI), NA, NA )
migr_data1$Country  <- as.character(migr_data1$Country)
migr_data1          <- rbind(migr_data1, GM1)
migr_data1$ACMI     <- as.numeric(migr_data1$ACMI)
migr_data1$MEI      <- as.numeric(migr_data1$MEI)
migr_data1$ACMI     <- round(migr_data1$ACMI, digits = 3)
migr_data1$MEI      <- round(migr_data1$MEI, digits = 3)
migr_data1$X.19.BSU <- as.character(migr_data1$X.19.BSU)
migr_data1$GM_ACMI  <- c(rep(NA, nrow(migr_data1)-1 ), migr_data1[nrow(migr_data1),"ACMI"])
migr_data1$GM_MEI   <- c(rep(NA, nrow(migr_data1)-1 ), migr_data1[nrow(migr_data1),"MEI"])
migr_data1$smallBSU <- NA
for (i in 1:nrow(migr_data1) ) {
if ( !is.na(migr_data1[i,"X.19.BSU"]) && migr_data1[i,"X.19.BSU"] == "N" ) {
migr_data1[i,"smallBSU"] <- migr_data1[i,"MEI"]
}
}
migr_data1$ACMIlessGM <- NA
for (i in 1:nrow(migr_data1) ) {
if ( migr_data1[i,"ACMI"] < migr_data1[nrow(migr_data1),"GM_ACMI"] ) {
migr_data1[i,"ACMIlessGM"] <- migr_data1[i,"ACMI"]
}
}
migr_data1$MEIlessGM <- NA
for (i in 1:nrow(migr_data1) ) {
if ( migr_data1[i,"MEI"] < migr_data1[nrow(migr_data1),"GM_MEI"] ) {
migr_data1[i,"MEIlessGM"] <- migr_data1[i,"MEI"]
}
}
#View(migr_data1)
# ACMI
ACMI_1 <- ggplot(data = migr_data1) +
geom_col( aes(x=reorder(Country, `ACMI`), y=`ACMI`),
width=.7, fill="#F9A51B", colour="#F9A51B") +
geom_col( aes(x=reorder(Country, `ACMI`), y=`GM_ACMI`),
width=.7, fill="#0D4DA1", colour="#0D4DA1") +
geom_col( aes(x=reorder(Country, `ACMI`), y=`ACMIlessGM`),
width=.7, fill="#3776A9", colour="#3776A9") +
coord_flip() +
theme_void() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text=element_text(size=12, hjust=1.0),
text=element_text(family="Arial Narrow"),
panel.background = element_rect(fill = "#C6D8E9", colour = NA),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm")
) +
geom_text(data = subset(migr_data1, ACMI > 2.8),
aes(x=Country, y=0.5*ACMI, label=sprintf("%0.1f", round(ACMI, digits = 1))),
size = 3.3, colour="white", fontface = "bold" ) +
geom_text(data = subset(migr_data1, ACMI < 2.8),
aes(x=Country, y=ACMI+0.5, label=sprintf("%0.1f", round(ACMI, digits = 1)), hjust=0),
size = 3.3, colour="#231F20", fontface = "bold" )
